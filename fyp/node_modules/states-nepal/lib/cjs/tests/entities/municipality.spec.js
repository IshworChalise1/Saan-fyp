"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const municipality_1 = require("../../src/entities/municipality");
const utils_1 = require("../../src/utils");
const APP_LANG = 'np';
const _municipality = new municipality_1.Municipality(APP_LANG);
describe('Test Municipality entities', () => {
    it('should test number of municipalities in Nepal', () => {
        expect(_municipality.allMunicipalities().length).toBe(753);
    });
    it('should test find municipality by Id', () => {
        const correctRange = (0, utils_1.range)(1, 753);
        correctRange.forEach(id => {
            const item = _municipality.find(id);
            expect(item).not.toBeNull();
        });
        const incorrectRange = (0, utils_1.range)(754, 1000);
        incorrectRange.forEach(id => {
            const item = _municipality.find(id);
            expect(item).toBeNull();
        });
    });
    it('should return the largest municipality by area', () => {
        const largest = _municipality.largest();
        expect(largest).toMatchObject({ id: 617, district_id: 62, category_id: 4 });
    });
    it('should return the smallest municipality by area', () => {
        const smallest = _municipality.smallest();
        expect(smallest).toMatchObject({ id: 274, district_id: 23, category_id: 3 });
    });
    it('should test municipality wards', () => {
        let wards = [];
        if (APP_LANG === 'np') {
            const wardsRange = (0, utils_1.range)(1, 33);
            wards = wardsRange.map(i => String(i)).map(el => (0, utils_1.numericNepali)(el));
        }
        else {
            wards = (0, utils_1.range)(1, 33);
        }
        const set = (0, utils_1.range)(1, 753);
        set.forEach(id => {
            const muniWards = _municipality.wards(id);
            const result = muniWards === null || muniWards === void 0 ? void 0 : muniWards.filter(x => !wards.includes(x));
            expect(result === null || result === void 0 ? void 0 : result.length).toBe(0);
        });
    });
    it('should test municipalities categories', () => {
        const set = (0, utils_1.range)(1, 753);
        set.forEach(id => {
            const municipality = _municipality.find(id);
            const result = municipality && (0, utils_1.range)(1, 4).includes(municipality.category_id);
            expect(result).toBeTruthy();
        });
    });
    it('should test municipalities districts', () => {
        const set = (0, utils_1.range)(1, 753);
        set.forEach(id => {
            const municipality = _municipality.find(id);
            const result = municipality && (0, utils_1.range)(1, 77).includes(municipality.district_id);
            expect(result).toBeTruthy();
        });
    });
    it('should search municipalities that match with given key', () => {
        const keywords = [
            'id',
            'district_id',
            'category_id',
            'name',
            'area_sq_km',
            'website',
            'wards',
        ];
        const allMunicipalities = _municipality.allMunicipalities();
        for (const key of keywords) {
            for (const value of allMunicipalities) {
                const items = _municipality.search(key, value[key]);
                expect(items.length).toBeGreaterThanOrEqual(1);
            }
        }
    });
});
//# sourceMappingURL=municipality.spec.js.map